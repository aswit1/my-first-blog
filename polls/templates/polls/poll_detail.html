{% extends 'blog/base.html' %}

{% block content %}
    <article class="poll">
        <div class="row">
            <div class="col col-6">
                <h2>{{ poll.title }}</h2>
                <p>{{ poll.text|linebreaksbr }}</p>
            </div>
            <div class="col col-4">
                {% if poll.published_date %}
                    <time class="date" style="margin-right: 30px">
                        Posted: {{ poll.published_date }}
                    </time><br>
                {% endif %}
                {% if poll.edit_date %}
                    <time class="date">
                        Last edited: {{ poll.edit_date }}
                    </time><br>
                {% endif %}
                {% if poll.author %}
                    <span>Posted by: {{poll.author}}</span>
                {% endif %}
            </div>
            <div class="col col-2">
               <aside class="actions">
                    {% if request.user.is_superuser or request.user == poll.author %}
                        <a class="btn btn-secondary" href="{% url "poll_delete" pk=poll.pk %}">
                            {% include 'blog/icons/trash.svg' %}
                        </a>
                    {% endif %}
                    {% if request.user == poll.author %}
                        <a class="btn btn-secondary" href="{% url "add_options" pk=poll.pk %}">
                            Add Options
                        </a>
                        <a class="btn btn-secondary" href="{% url "poll_edit" pk=poll.pk %}">
                            {% include 'blog/icons/pencil-fill.svg' %}
                        </a>
                    {% endif %}
                </aside>

            </div>
        </div>
        <div class="row">
            <div class="col">
                <table class="table">
                    <tr>
                        <th scope="col">Options</th>
                        <th scope="col">Votes</th>
                    </tr>
                    {% for option in options %}
                        <tr>
                            <td>
                                {{ option.description }}
                            </td>
                            <td>
                                {{ option.votes }}
                            </td>
                            <td>
                                {% if request.user.is_superuser or request.user == poll.author %}
                                    <a class="btn btn-secondary" href="{% url "options_delete" pk=option.pk %}">
                                        {% include 'blog/icons/trash.svg' %}
                                    </a>
                                {% endif %}
                            </td>
                        </tr>
                    {% endfor %}
                </table>
            </div>
        </div>
        <div class="row">
           {% if user.is_authenticated %}
              <a href="{% url 'poll_vote' pk=poll.pk %}" class="btn btn-secondary justify-content-end">
                  Vote
              </a>
           {% endif %}
{#            <div class="col">#}
{#                <button class="save btn btn-secondary">Option 1</button>#}
{#                <button class="save btn btn-secondary">Option 2</button>#}
{#                <button class="save btn btn-secondary">Option 3</button>#}
{#                <button class="save btn btn-secondary">Option 4</button>#}
{#            </div>#}
        </div>
    </article>
{% endblock %}